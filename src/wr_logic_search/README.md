# Search AI

@defgroup wr_logic_search wr_logic_search
@brief Search Pattern logic

## State Machine
The State Machine has a state just for searching, which will be ran a minimum of five times for the three aruco tags, the orange mallet, and the water bottle. Long Range will receive the starting coordinate, and once the rover has reached this coordinate, it will switch to the Search state. In the Search state, the rover will travel to coordinates in a square spiral with a radius of 20 meters since target objects can be at most 20 meters away from the starting coordinate. At each coordinate, a service for the rover's camera will do a 360-degree scan of the surrounding area. If the target is found, the rover will go from the Search state to the Short Range state, if the target is not found, the rover will continue to the next coordinate, and if the target is not found after the rover scans its surroundings at the last coordinate, the rover will go to the starting coordinate, and the state will start over.

## Coordinate Calculations
The Autonomous Navigation mission is run on GPS coordinates. The starting coordinates for each state are given, but for Search Pattern, since we need to look for the target objects at coordinates that are not the starting coordinate to actually find the objects, we need a systemized way to find these other coordinates. In the python file coord_calculations.py, we calculate GPS coordinates considering the curvature of the Earth. Even though the distances the rover will travel are not large, this will maximize accuracy. The search pattern is a square spiral, so beginning from the starting coordinate, the rover travels north, east, south, and west for a set number of vertices/coordinates. A list of dictionaries, representing one coordinate, are returned and will be iterated through for searching.

## Travel Timer
Search Pattern uses the obstacle avoidance from Long Range, so we need a way to determine if the rover has reached an obstacle that has completely blocked off the rover's path set by the list of calculated coordinates. This is done by using a timer. There is a timer for each specific coordinate traveled too based on the distance between the current coordinate and the target coordinate. If the rover takes longer than the max time, then the rover will skip to the next coordinate, assuming that the coordinate is unreachable. There is also a timer for the entire state, which is determined by the sum of the distances between each of the calculated coordinates. If the rover takes longer than the max time, it is assumed that the rover's path is obstructed by an obstacle that makes the entire path unusable. In this case, the rover goes back to the starting coordinate and restarts the searching process.